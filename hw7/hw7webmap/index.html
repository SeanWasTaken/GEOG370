<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/qgis2web.css"><link rel="stylesheet" href="css/fontawesome-all.min.css">
        <style>
        #map {
            width: 1141px;
            height: 877px;
        }
        </style>
        <title></title>
    </head>
    <body>
        <h1>Homework 7: Chloropleth or Proportional Symbol Map</h1>
        <h2>Sean Billy</h2>
        <h1>Railway Passengers Carried in 2015</h1>
        <p>This map shows the number of Passengers carried multiplied by kilometers traveled, with the unit of passenger-kilometers. 
            I selected this topic because I'm interested in means of travel that are not cars, and knowing how bad the United States'
            passenger rail system is, I wanted to see how it compares to the rest of the world. I chose the year 2015 to display because
            it was the most recent year with data for a large amount of countries. An issue I ran into while creating this visualization 
            is that China and India's rail passengers carried are much higher than the rest of the world, so I had to play with the categories
             to make it look right.
        </p>
        <h1>PNG Map</h1>
        <img src="pngmap.png" alt="PNG version of the map." width="1200">
        <h2>Web Map</h2>

        <div id="map">
        </div>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="data/PassengersCarriedKmTraveled_0.js"></script>
        <script>
        var map = L.map('map', {
            zoomControl:true, maxZoom:6, minZoom:2
        }).fitBounds([[-69.19575053493958,-201.8884300328877],[190.91242956032852,136.698103828267]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        function pop_PassengersCarriedKmTraveled_0(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">Country</th>\
                        <td>' + (feature.properties['ADMIN'] !== null ? autolinker.link(feature.properties['ADMIN'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Code</th>\
                        <td>' + (feature.properties['ADM0_A3'] !== null ? autolinker.link(feature.properties['ADM0_A3'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Year</th>\
                        <td>' + (feature.properties['2015_passengers_carried_Year'] !== null ? autolinker.link(feature.properties['2015_passengers_carried_Year'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Passengers * km Traveled</th>\
                        <td>' + (feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] !== null ? autolinker.link(feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_PassengersCarriedKmTraveled_0_0(feature) {
            if (feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] >= 6989999.771000 && feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] <= 10300000000.000000 ) {
                return {
                pane: 'pane_PassengersCarriedKmTraveled_0',
                opacity: 1,
                color: 'rgba(0,0,0,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,235,254,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] >= 10300000000.000000 && feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] <= 36043875000.000000 ) {
                return {
                pane: 'pane_PassengersCarriedKmTraveled_0',
                opacity: 1,
                color: 'rgba(0,0,0,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(239,176,232,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] >= 36043875000.000000 && feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] <= 76787835938.000000 ) {
                return {
                pane: 'pane_PassengersCarriedKmTraveled_0',
                opacity: 1,
                color: 'rgba(0,0,0,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(223,118,210,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] >= 76787835938.000000 && feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] <= 427000000000.000000 ) {
                return {
                pane: 'pane_PassengersCarriedKmTraveled_0',
                opacity: 1,
                color: 'rgba(0,0,0,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(206,59,187,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] >= 427000000000.000000 && feature.properties['2015_passengers_carried_Railways, passengers carried * km traveled (million passenger-km)'] <= 1200000000000.000000 ) {
                return {
                pane: 'pane_PassengersCarriedKmTraveled_0',
                opacity: 1,
                color: 'rgba(0,0,0,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(190,0,165,1.0)',
                interactive: true,
            }
            }
        }
        map.createPane('pane_PassengersCarriedKmTraveled_0');
        map.getPane('pane_PassengersCarriedKmTraveled_0').style.zIndex = 400;
        map.getPane('pane_PassengersCarriedKmTraveled_0').style['mix-blend-mode'] = 'normal';
        var layer_PassengersCarriedKmTraveled_0 = new L.geoJson(json_PassengersCarriedKmTraveled_0, {
            attribution: '',
            interactive: true,
            dataVar: 'json_PassengersCarriedKmTraveled_0',
            layerName: 'layer_PassengersCarriedKmTraveled_0',
            pane: 'pane_PassengersCarriedKmTraveled_0',
            onEachFeature: pop_PassengersCarriedKmTraveled_0,
            style: style_PassengersCarriedKmTraveled_0_0,
        });
        bounds_group.addLayer(layer_PassengersCarriedKmTraveled_0);
        map.addLayer(layer_PassengersCarriedKmTraveled_0);
        setBounds();
        </script>
        <p></p>
        <h2>Data used for this project</h2>
        <a href="https://ourworldindata.org/grapher/railways-passengers-carried-passenger-km"> Original Data </a>
        <p></p>
        <a href="2015_passengers_carried.csv"> Cleaned CSV </a>
        <p></p>
        <a href="railpassengers_4326.geojson"> Vector File </a>
    </body>
</html>
